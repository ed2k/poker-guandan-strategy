(this["webpackJsonpguandan-app"]=this["webpackJsonpguandan-app"]||[]).push([[0],{112:function(e,t,n){},142:function(e,t,n){"use strict";n.r(t);var a=n(147),r=(n(112),n(102)),s=n.n(r),l=n(0),c=n.n(l),o=n(7),i=n(8),u=n(101),d=n(58),b=n(146),g=n(1);function h(e){return requestAnimationFrame((()=>{requestAnimationFrame((()=>{requestAnimationFrame((()=>{e()}))}))}))}const j=e=>{let{children:t,style:n,timeout:a,...r}=e;const[s]=Object(l.useState)(new b.a.Value(0));return Object(g.jsx)(d.Transition,{timeout:a+300,onEntering:()=>{h((()=>{b.a.timing(s,{toValue:1,duration:a}).start()}))},onExiting:()=>{h((()=>{b.a.timing(s,{toValue:0,duration:a}).start()}))},...r,children:Object(g.jsx)(b.a.View,{style:[{opacity:s},n],children:t})})};j.defaultProps={appear:!0,enter:!0,mountOnEnter:!0,unmountOnExit:!0};var y=n(148),p=n(36),x=n(103);const f={H:{value:"H",label:"\u2665",text:"\u2665",color:"red"},D:{value:"D",label:"\u2666",text:"\u2666",color:"red"},S:{value:"S",label:"\u2660",text:"\u2660",color:"black"},C:{value:"C",label:"\u2663",text:"\u2663",color:"black"}},k={B:{value:"B",label:"",text:"B",color:"black"},R:{value:"R",label:"",text:"R",color:"red"}},O={...f,...k},R=[f.H,f.S,f.C,f.D];const m={S:"C",C:"D",D:"H",H:void 0};const A=12,w=13,S=1,C=14,E=15,T=S,I=E,L=[S,2,3,4,5,6,7,8,9,10,11,12,w,C,E],v={[S]:{label:"A",text:"A",naturalRank:S},2:{label:"2",text:"2",naturalRank:2},3:{label:"3",text:"3",naturalRank:3},4:{label:"4",text:"4",naturalRank:4},5:{label:"5",text:"5",naturalRank:5},6:{label:"6",text:"6",naturalRank:6},7:{label:"7",text:"7",naturalRank:7},8:{label:"8",text:"8",naturalRank:8},9:{label:"9",text:"9",naturalRank:9},10:{label:"10",text:"10",naturalRank:10},11:{label:"J",text:"J",naturalRank:11},12:{label:"Q",text:"Q",naturalRank:12},[w]:{label:"K",text:"K",naturalRank:w},[C]:{label:"Joker",text:"J",naturalRank:C},[E]:{label:"Joker",text:"J",naturalRank:E}};const B=L.slice(0,L.length-2);const P=o.a.create({card:{width:74,height:100,backgroundColor:"white",borderColor:"black",borderWidth:2,borderRadius:4},cardLarge:{width:100,height:134},cardStacked:{marginRight:-52,marginBottom:-52},cardStackedLarge:{marginRight:-68,marginBottom:-68},cardLabel:{fontFamily:"monospace",fontSize:16,lineHeight:16,textAlign:"center",width:20,marginTop:4,fontWeight:"bold"},cardLabelLarge:{fontSize:24,lineHeight:24,width:30},cardCuteImage:{position:"absolute",left:"calc(50% - 20px)",top:"calc(50% - 20px)",width:40,height:40},cardCuteImageLarge:{width:56,height:56,left:"calc(50% - 28px)",top:"calc(50% - 28px)"},overlayWhenDisabled:{position:"absolute",left:0,right:0,top:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.3)"}});function H(e){let{rank:t,suit:n,isStacked:a,disabled:r,style:s,large:l}=e;const c=v[t],o=O[n];return Object(g.jsxs)(i.a,{style:[P.card,l&&P.cardLarge,a&&P.cardStacked,a&&l&&P.cardStackedLarge,s],children:[Object(g.jsxs)(u.a,{style:[P.cardLabel,l&&P.cardLabelLarge,{color:o.color}],children:["10"===c.label?c.label:c.label.split("").join("\n"),"\n",o.label]}),Object(g.jsx)(x.a,{source:{uri:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAQAAAAm93DmAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAHdElNRQfjAhUINB2XPPnXAAAEaElEQVRIx52WWWxUZRTHf3e2TmfrdJlaSWlRlkK6AA1BiCQNWzRIUBACwS1Go2LE0JASwaSVh8qDxroEhBcJFBMTbNQGFRIftAqoIBpKY9vU0EUK0xY6bYdZ78zxodLZ7nTh/3bv+c7vnO+c8333wv0olwp0M3EoZBMZaa0KB/mFnJkAd+BhW1rrKr1b6aV4JsDXHWJpZYGmLcdwdqvMGqRM21W7Es71bCmjFpuG7cWV62qwmrDMJMP63fKPLA3yhjHZsjynt1nuyJIA67VdDZpvc208TJ3ppZrbV2jHRTYWwIuP/c/O3kCQLCO50wfqsDsI4aSwaPiEy5eX77SaDeAPDQcHsjv4kJWYdem6rAXUK47f2M5tqtg3byEF2DAihDO93KKV83xFB5Rg5e506mdgQ0bXajkuNyQqWopIjxyVR/3GM1RNPd5ZHJx/56gMy1QakPekyE0N1slwLuXkOvWPKWHjisrPsiLIYZzpcNmceira9//yoLSLOwHgl0tyMwnaIWtUjmjOKwYOrY30TSxtEpdsE1+c8xdikxcknIJcHuKtWC1jRX1szq53dYUTj0bCWBJqbqOYwpQuLKDe+EA1q1KaofxQnxA5KJfFLaoEREQVv4hEZFD8ml3fKzSRmQjcXO7v0VjcJPslJEekJmWr8bomxSOsid+yjk2Pm4sSIrj5Hcihidf4iJI0Z3RcC1ntYKMS96bA2vZ9UtRjsklCEpW3BdknYRG5LuckkibHE6K/SNZ4bwEKXbOSLz8HrRzCyRnycRPEwHE6WZsmxzKyi4cKGLkHzHdZks/6RsY4Thd1VLCbXRRymnfQpwEWkGcfirt/nlwV9mpspFmWyYCIXJC5skJOJkxlogZlsY+qWFN8PjWgEbecMFcAJzbe57nkyYiTD1+YQAzoHvAOaSwrYi0f0EcjD7KUydTPkIfBGPDfwe5rGst07EXhCb7kzSk+IX/h6eLWxGMGNLya5vbrlQZpFnXSeycoW4TaxBBVDw23yf3qguTfojIRmMHne6bII50C8rxwOHWiluX1NN8XsFHs7SxKKaseXll8988Z41pknocd2q0yUfeIf7ofgHH9KKVjVKc9QJg5UDry9aRXVUxBOSVzh9iNkUlkYHtu9x7pTDNE9xSRq/Ky2L08g5IISE42SmegKlByji4cZGsG93KJjzlGDn2BsU/oS84oWZmG/APY2ck3zKeCcopwYATCeOjmKq10E6CRUjba+mdzcSqgJdOZw2VG1R2GCvaOqS3OrMxsvRlUv++Ox++o+tTsppYeKjGm7lADqFMMn/Fdf+Ts+Z0FZrUzVD0QwooJCOElK3S6t6RJ9bQ2lFaaIiDJ7rGS5lNJMS7mKFuVrOgNbuqWWAzeUfqQCTcFhSKzPaRGr+vnPG38VXp/oo1Rhujnb9pQ44EL2cwiCnBiwoYBK1HAhDmlbRECKIgSJChRvHi5TQ8tfEuQpKbrMJFBBhb02NEBFo3fDJVhBAjgJ8xdQoQI3zP+B8PxaLIJz6YTAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE5LTAyLTIxVDA4OjUyOjI5KzAwOjAwIu73FAAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxOS0wMi0yMVQwODo1MjoyOSswMDowMFOzT6gAAAAASUVORK5CYII="},style:[P.cardCuteImage,l&&P.cardCuteImageLarge]}),r&&Object(g.jsx)(i.a,{style:P.overlayWhenDisabled})]})}const U=e=>{let{cards:t,hands:n,style:a,large:r}=e;const s=r?68:52;return Object(g.jsxs)(p.a,{style:a,contentContainerStyle:{flexWrap:"wrap",flexDirection:"row",padding:0,paddingRight:s+0,paddingBottom:s+0},children:[!!t&&t.map(((e,t)=>Object(g.jsx)(H,{...e,isStacked:!0,large:r},e.rank+e.suit+t))),!!n&&n.map(((e,t)=>{const n=e.map(((e,t)=>Object(g.jsx)(H,{...e,isStacked:!0,large:r},e.rank+e.suit+t)));return t>0?Object(g.jsx)(i.a,{style:{flexDirection:"row",flexWrap:"nowrap",marginRight:13},children:n},t):Object(g.jsx)(i.a,{style:{flexDirection:"row",flexWrap:"wrap",marginRight:13,maxWidth:"100%"},children:n},t)}))]})},F=L.map((e=>e===C?[{rank:e,suit:"B"}]:e===E?[{rank:e,suit:"R"}]:R.map((t=>({rank:e,suit:t.value}))))).reduce(((e,t)=>(e.push(...t),e)),[]),G=L.map((e=>e===C?[{rank:e,suit:"B"}]:e===E?[{rank:e,suit:"R"}]:R.map((t=>({rank:e,suit:t.value,dedup:1}))))).reduce(((e,t)=>(e.push(...t),e)),[]);function W(e,t){return e.rank!==t.rank?e.rank-t.rank:e.suit<t.suit?-1:e.suit===t.suit?0:1}function N(e){return e.sort(W)}function J(){const e=function(e){for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1)),a=e[t];e[t]=e[n],e[n]=a}return e}([...F,...G]);return[N(e.slice(0,27)),N(e.slice(27,54)),N(e.slice(54,81)),N(e.slice(81,108))]}function D(e,t){return e.filter((e=>0===W(e,t))).length<2}const z=o.a.create({divider:{height:2,backgroundColor:"black",marginHorizontal:10}});function K(){return Object(g.jsx)(i.a,{style:z.divider})}const M=e=>{let{style:t,titleStyle:n,title:a,disabled:r,...s}=e;return Object(g.jsx)(y.a,{style:[{backgroundColor:r?_.disabled.background:_.button.background,borderRadius:2,paddingVertical:8,paddingHorizontal:4,alignItems:"center",justifyContent:"center"},t],disabled:r,...s,children:Object(g.jsx)(u.a,{style:[{color:r?_.disabled.text:"white",textAlign:"center"},n],children:a})})},Q="rgb(33, 150, 243)",V={0:"black",4:"rgb(161, 161, 161)",6:"rgb(223, 223, 223)",8:"white"},_={disabled:{background:V[6],text:V[4]},button:{background:Q}};function Z(){const{value:e,increase:t,decrease:n}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const[t,n]=Object(l.useState)(e),a=Object(l.useCallback)((()=>n((e=>e+1))),[n]),r=Object(l.useCallback)((()=>n((e=>e-1))),[n]);return{value:t,increase:a,decrease:r}}(S);return{rank:e,incRank:t,decRank:n}}const Y=o.a.create({incDecButton:{flex:2,minWidth:80,maxWidth:200,margin:6},actionButton:{flex:1,minWidth:80,maxWidth:150,margin:6},buttonTitle:{fontSize:20},buttonTitleSmall:{fontSize:20}}),q=e=>Object(g.jsxs)(i.a,{children:[Object(g.jsxs)(i.a,{style:{flexDirection:"row",justifyContent:"center",alignContent:"center"},children:[Object(g.jsx)(M,{onPress:e.decRank,disabled:e.rank<=T,title:"<",style:Y.incDecButton,titleStyle:Y.buttonTitle}),Object(g.jsx)(M,{onPress:e.incRank,title:">",disabled:e.rank>=I,style:Y.incDecButton,titleStyle:Y.buttonTitle})]}),Object(g.jsxs)(i.a,{style:{flexDirection:"row",justifyContent:"center",alignContent:"center"},children:[Object(g.jsx)(M,{onPress:e.randomCards,title:"\u968f\u673a\u53d1\u724c",disabled:e.numberOfCards>0,style:Y.actionButton,titleStyle:Y.buttonTitleSmall}),Object(g.jsx)(M,{onPress:e.clearCards,title:"\u6e05\u9664",disabled:0===e.numberOfCards,style:Y.actionButton,titleStyle:Y.buttonTitle}),Object(g.jsx)(M,{onPress:e.deleteLastCard,title:"\u5220\u9664",disabled:0===e.numberOfCards,style:Y.actionButton,titleStyle:Y.buttonTitle})]})]}),X=e=>Object(g.jsx)(g.Fragment,{children:e.cardsLeft.map((t=>{const n=D(e.cards,t);return Object(g.jsx)(y.a,{onPress:()=>e.addCard(t),disabled:!n,children:Object(g.jsx)(H,{suit:t.suit,rank:t.rank,disabled:!n,style:{marginRight:-36,marginBottom:5},large:e.large})},JSON.stringify(t))}))});function $(e){let{cards:t,allCards:n,addCard:a,clearCards:r,randomCards:s,deleteLastCard:l,windowSize:c}=e;const{rank:o,incRank:d,decRank:b}=Z();return Object(g.jsxs)(i.a,{style:{flex:1},children:[Object(g.jsx)(i.a,{style:{flex:1,alignItems:"center",justifyContent:"center"},children:Object(g.jsx)(U,{cards:t,style:{height:60,padding:6},large:"BIG"===c})}),Object(g.jsx)(i.a,{style:{flex:1,alignItems:"flex-start",justifyContent:"flex-start"},children:Object(g.jsx)(U,{cards:t,style:{height:60,padding:6},large:"BIG"===c})}),Object(g.jsx)(i.a,{style:{flex:1,alignItems:"flex-end",justifyContent:"flex-end"},children:Object(g.jsx)(U,{cards:t,style:{height:60,padding:6},large:"BIG"===c})}),Object(g.jsx)(i.a,{style:{flex:1,alignItems:"center",justifyContent:"center"},children:Object(g.jsx)(U,{cards:t,style:{height:60,padding:6},large:"BIG"===c})}),Object(g.jsx)(K,{}),Object(g.jsx)(u.a,{style:{fontSize:14,margin:4},children:"\u70b9\u51fb\u6251\u514b\u724c\u6dfb\u52a0\uff0c\u76ee\u524d\u5df2\u6709".concat(t.length,"\u5f20\u724c")}),Object(g.jsx)(p.a,{style:{height:"SMALL"===c?110:150,flexGrow:0},contentContainerStyle:{flex:1,justifyContent:"center"},horizontal:!0,children:Object(g.jsx)(X,{cards:t,cardsLeft:n[0],addCard:a,rank:o,large:"BIG"===c})}),Object(g.jsx)(q,{numberOfCards:t.length,clearCards:r,randomCards:s,deleteLastCard:l,rank:o,incRank:d,decRank:b})]})}var ee=n(149);function te(e){let{rank:t,setRank:n}=e;return Object(g.jsx)(i.a,{style:{flexDirection:"row"},children:Object(g.jsxs)(u.a,{style:{fontSize:22,marginHorizontal:6},children:["\u5f53\u524d\u6253",Object(g.jsx)(ee.a,{selectedValue:t,onValueChange:e=>n(function(e){if(!Number.isInteger(e)||e<=0||e>=C)throw new Error("rank ".concat(e," is not valid non-joker natural rank"));return e}(parseInt(e,10))),children:B.map((e=>Object(g.jsx)(ee.a.Item,{label:v[e].label,value:e},e)))})," ",Object(g.jsxs)(u.a,{style:{color:O.H.color},children:[O.H.label,v[t].label]}),"\u662f\u767e\u642d"]})})}const ne=o.a.create({container:{padding:10},borderBox:{borderWidth:2,borderColor:"black"}}),ae=e=>{let{rank:t,setRank:n,cards:a,allCards:r,clearCards:s,addCard:c,randomCards:o,deleteLastCard:u,navigation:d,windowSize:b}=e;const h=Object(l.useCallback)((()=>{d.navigate("Result")}),[]);return Object(g.jsxs)(l.Fragment,{children:[Object(g.jsx)(i.a,{style:[ne.container,{flexDirection:"row",height:40,justifyContent:"center",alignItems:"center"}],children:Object(g.jsx)(te,{rank:t,setRank:n})}),Object(g.jsx)(K,{}),Object(g.jsx)(i.a,{style:{flex:1},children:Object(g.jsx)($,{cards:a,allCards:r,addCard:c,clearCards:s,randomCards:o,deleteLastCard:u,windowSize:b})}),Object(g.jsx)(i.a,{style:[ne.container,{justifyContent:"center",padding:6}],children:Object(g.jsx)(M,{title:"\u5f00\u59cb\u62c6\u724c",onPress:h,style:{height:60},titleStyle:{fontSize:28}})})]})},re=c.a.memo(ae);var se,le,ce=function(e){let{screenProps:t,navigation:n}=e;return Object(g.jsx)(re,{...t,navigation:n})},oe=n(39);function ie(){return ie=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},ie.apply(this,arguments)}function ue(e,t){let{title:n,titleId:a,...r}=e;return l.createElement("svg",ie({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",ref:t,"aria-labelledby":a},r),n?l.createElement("title",{id:a},n):null,se||(se=l.createElement("path",{fill:"none",d:"M0 0h24v24H0V0z"})),le||(le=l.createElement("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"})))}const de=l.forwardRef(ue);n.p;function be(e){let{natural:t,context:n}=e;return{natural:t,power:n.getOrder(t)}}function ge(e){return{rank:e.rank.natural,suit:e.suit}}const he=e=>Object(g.jsx)(y.a,{style:[{width:40,flexDirection:"row",justifyContent:"center",alignItems:"center"},e.style],onPress:e.onClose,children:Object(g.jsx)(de,{})}),je=e=>{let{strategyResult:t,rank:n,windowSize:a}=e;return Object(g.jsx)(g.Fragment,{children:t&&("loading"===t?Object(g.jsx)(u.a,{style:{fontSize:20},children:"\u8ba1\u7b97\u4e2d"}):Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(i.a,{style:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},children:Object(g.jsx)(u.a,{style:{fontSize:18,flexShrink:0,marginRight:20},children:"\u5206\u6570".concat(t.plans[0].score)})}),Object(g.jsx)(i.a,{children:(()=>{const e=t.plans.length-5;return Object(g.jsxs)(g.Fragment,{children:[t.plans.slice(0,5).map(((e,t)=>Object(g.jsx)(U,{hands:e.plays.map((e=>e.cards.map(ge))),style:{margin:6},large:"BIG"===a},t))),e>0&&"\u8fd8\u6709".concat(e,"\u79cd\u65b9\u6848")]})})()})]}))})},ye=Object(l.memo)(je),pe=e=>{let{strategyResult:t,rank:n,onClose:a,windowSize:r}=e;return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsxs)(i.a,{style:{flexDirection:"row",justifyContent:"flex-end",alignContent:"center"},children:[Object(g.jsx)(i.a,{style:{flex:1},children:Object(g.jsx)(u.a,{style:{fontSize:20,padding:4,textAlign:"center"},children:"\u62c6\u724c\u7b56\u7565\u8ba1\u7b97\u7ed3\u679c"})}),Object(g.jsx)(he,{onClose:a,style:{position:"absolute",right:0,height:"100%"}})]}),Object(g.jsx)(K,{}),Object(g.jsx)(p.a,{style:[ne.container,{flex:2}],children:t.map((e=>Object(g.jsx)(ye,{strategyResult:e,rank:n,windowSize:r})))})]})};var xe=c.a.memo(pe);const fe=!1,ke=1e7;let Oe=function(e){return e[e.UNKNOWN=0]="UNKNOWN",e[e.SINGLE=1]="SINGLE",e[e.PAIR=2]="PAIR",e[e.TRIPLE=3]="TRIPLE",e[e.FULL_HOUSE=4]="FULL_HOUSE",e[e.STRAIGHT=5]="STRAIGHT",e[e.TUBE=6]="TUBE",e[e.PLATE=7]="PLATE",e[e.STRAIGHT_FLUSH=8]="STRAIGHT_FLUSH",e[e.BOMB_N_TUPLE=9]="BOMB_N_TUPLE",e[e.FOUR_JOKER=10]="FOUR_JOKER",e}({});const Re={[Oe.STRAIGHT_FLUSH]:Oe.BOMB_N_TUPLE,[Oe.BOMB_N_TUPLE]:Oe.PLATE,[Oe.PLATE]:Oe.TUBE,[Oe.TUBE]:Oe.STRAIGHT,[Oe.STRAIGHT]:Oe.PAIR,[Oe.PAIR]:Oe.TRIPLE,[Oe.TRIPLE]:void 0};const me={rank:S,suit:"S",type:Oe.STRAIGHT_FLUSH};function Ae(e){const t=function(e){const t=e+1;if(!(t>E))return t}(e.rank);if(null!=t)return{...e,rank:t};if(e.suit){console.assert(e.type===Oe.STRAIGHT_FLUSH);const t=(n=e.suit,m[n]);if(null!=t)return{...e,rank:S,suit:t}}var n;const a=(r=e.type,Re[r]);var r;return null!=a?{...e,rank:S,type:a,suit:void 0}:void 0}function we(e){let{cards:t,collectPlan:n,context:a}=e;ze({cardsByRank:Ce(t,a),context:{collectPlan:n,game:a,debug:fe}})}const Se=0;function Ce(e,t){const n={};return e.forEach((e=>{const a=t.isWildCard(e)?Se:e.rank.natural;n[a]=n[a]||[],n[a].push(e)})),n}function Ee(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;console.assert(n>=1);const a=e[t]||[];if(n<=a.length){const r=a.slice(0,n);return e[t]=a.slice(n),r}const r=e[Se],s=n-a.length;if(!r||s>r.length)return;const l=a.concat(r.slice(0,s));return e[t]=[],e[Se]=r.slice(s),l}function Te(e,t,n){const a=e[t]||[],r=a.findIndex((e=>e.suit===n));if(r>=0)return e[t]=[...a],e[t].splice(r,1),a[r];const s=e[Se]||[];return s.length>0?(e[Se]=s.slice(1),s[0]):void 0}const Ie=e=>t=>{let{cards:n,nowRank:a,plan:r,context:s}=t;const l={...n},c=Ee(l,a,e);if(null==c)return;const o={type:2===e?Oe.PAIR:3===e?Oe.TRIPLE:Oe.BOMB_N_TUPLE,rank:s.game.getOrder(a),cardCount:e};return{cardsByRank:l,plan:{score:r.score+(e>3?0:1),plays:r.plays.concat({playRank:o,cards:c})}}},Le=e=>{let{cardCount:t,length:n,playType:a}=e;return e=>{let{cards:r,nowRank:s,plan:l,context:c}=e;c.debug&&console.log("playCardSequence: ".concat(JSON.stringify(r),", ").concat(s));const o=s+n-1;if(o>14)return;let i={...r},u={cards:[],playRank:{type:a,rank:s}};for(let n=s;n<=o;++n){const e=Ee(i,14===n?S:n,t);if(null===e)return;e&&u.cards.push(...e)}return{cardsByRank:i,plan:{score:l.score+1,plays:l.plays.concat(u)}}}},ve=Ie(2),Be=Ie(3),Pe=Ie(4),He=Ie(5),Ue=Ie(6),Fe=Ie(7),Ge=Ie(8),We=Le({cardCount:1,length:5,playType:Oe.STRAIGHT}),Ne=Le({cardCount:2,length:3,playType:Oe.TUBE}),Je=Le({cardCount:3,length:2,playType:Oe.PLATE}),De={[Oe.PAIR]:[ve],[Oe.TRIPLE]:[Be,e=>{let{cards:t,nowRank:n,plan:a,context:r}=e;const s=Be({cards:t,nowRank:n,plan:a,context:r});if(null==s)return;const{cardsByRank:l,plan:c}=s,o=c.plays.findIndex((e=>e.playRank.type===Oe.PAIR));if(o<0)return;const i=c.plays[c.plays.length-1],u=c.plays[o];return c.plays=c.plays.slice(0,o).concat(c.plays.slice(o+1,c.plays.length-1)),c.plays.push({playRank:{type:Oe.FULL_HOUSE,rank:i.playRank.rank},cards:i.cards.concat(u.cards)}),c.score=c.score-1,{plan:c,cardsByRank:l}}],[Oe.BOMB_N_TUPLE]:[Pe,He,Ue,Fe,Ge],[Oe.STRAIGHT]:[We],[Oe.TUBE]:[Ne],[Oe.PLATE]:[Je],[Oe.STRAIGHT_FLUSH]:[e=>{let{cards:t,nowRank:n,nowSuit:a,plan:r,context:s}=e;if(s.debug&&console.log("playStraightFlush: ".concat(JSON.stringify(t),", ").concat(n,", ").concat(a)),!a)return void console.assert(a);const l=n+5-1;if(l>14)return;let c={...t},o={cards:[],playRank:{type:Oe.STRAIGHT_FLUSH,rank:n}};for(let i=n;i<=l;++i){const e=Te(c,14===i?S:i,a);if(null==e)return;o.cards.push(e)}return{cardsByRank:c,plan:{score:r.score+0,plays:r.plays.concat(o)}}}]};function ze(e){var t;let{cardsByRank:n,plan:a={score:0,plays:[]},now:r=me,context:s}=e;s.debug&&console.log(Oe[r.type],r.rank,r.suit),null===(t=De[r.type])||void 0===t||t.forEach((e=>{const t=e({nowRank:r.rank,nowSuit:r.suit,cards:n,plan:a,context:s});null!=t&&ze({...t,now:r,context:s})}));const l=Ae(r);null!=l?ze({now:l,cardsByRank:n,plan:a,context:s}):s.collectPlan(function(e,t){const n={...e,plays:[...e.plays]};return Object.entries(t).forEach((e=>{let[t,a]=e;a&&(n.score+=a.length,a.forEach((e=>{n.plays.push({playRank:{type:Oe.SINGLE,rank:e.rank.power},cards:[e]})})))})),n}(a,n))}function Ke(e){switch(e){case E:return 14;case C:return 13;case S:return 12;default:return e-2}}class Me{constructor(e){this.mainRank=void 0,this.mainRank=e}getOrder(e){if(e===E)return 14;if(e===C)return 13;if(e===this.mainRank)return 12;{const t=Ke(e);return t>Ke(this.mainRank)?t-1:t}}isWildCard(e){return e.rank.natural===this.mainRank&&"H"===e.suit}}const Qe=e=>e.score,Ve=1e100,_e=e=>{const t={};return e.plays.forEach((e=>{t[e.playRank.type]=t[e.playRank.type]||0,t[e.playRank.type]+=function(e){const t=e.playRank;switch(t.type){case Oe.SINGLE:switch(t.rank){case 14:return-1;case 13:return-.8;default:return Ze({x:0,y:1},{x:12,y:-.2},t.rank)}case Oe.PAIR:switch(t.rank){case 14:return-1;case 13:return-.95;default:return t.rank>=9?Ze({x:9,y:0},{x:12,y:-.9},t.rank):Ze({x:9,y:0},{x:0,y:1},t.rank)}case Oe.TRIPLE:return t.rank>=9?Ze({x:9,y:0},{x:12,y:-1},t.rank):Ze({x:9,y:0},{x:0,y:1},t.rank);case Oe.FULL_HOUSE:return t.rank>=8?Ze({x:8,y:0},{x:12,y:-1},t.rank):Ze({x:8,y:0},{x:0,y:1},t.rank);case Oe.STRAIGHT:return t.rank>=7?Ze({x:7,y:0},{x:10,y:-1},t.rank):Ze({x:7,y:0},{x:S,y:.8},t.rank);case Oe.TUBE:return t.rank>=8?Ze({x:8,y:0},{x:A,y:-1},t.rank):Ze({x:8,y:0},{x:S,y:.5},t.rank);case Oe.PLATE:return t.rank>=6?Ze({x:6,y:0},{x:w,y:-1},t.rank):Ze({x:6,y:0},{x:S,y:.3},t.rank);case Oe.STRAIGHT_FLUSH:case Oe.BOMB_N_TUPLE:case Oe.FOUR_JOKER:return-1;default:throw new Error("Unknown play rank type")}}(e)})),t[Oe.SINGLE]=Ye(t[Oe.SINGLE],-3,Ve),t[Oe.PAIR]=Ye(t[Oe.PAIR],-2,6),t[Oe.TRIPLE]=Ye(t[Oe.TRIPLE],-.3,6),t[Oe.FULL_HOUSE]=Ye(t[Oe.FULL_HOUSE],-1.3,3),t[Oe.STRAIGHT]=Ye(t[Oe.STRAIGHT],-.8,1.5),t[Oe.TUBE]=Ye(t[Oe.TUBE],-.3,1),t[Oe.PLATE]=Ye(t[Oe.PLATE],-.2,.3),Object.values(t).reduce(((e,t)=>(e||0)+(t||0)))||0};function Ze(e,t,n){return(t.y-e.y)/(t.x-e.x)*(n-e.x)+e.y}function Ye(e,t,n){return null==e?0:e<t?t:e>n?n:e}function qe(e){let{cards:t,mainRank:n,morePlans:a=!0,scorer:r="HANDS"}=e;const s=new Me(n),l=t.map((e=>function(e,t){return{rank:be({natural:e.rank,context:t}),suit:e.suit}}(e,s))),c="HEURISTICS"===r?_e:Qe;if(a){const e=$e({scorer:c});we({cards:l,collectPlan:e.collectPlan,context:s});const t=e.getBestPlans();if(0===t.length)throw new Error("No plan found");return t}{const e=Xe({scorer:c});we({cards:l,collectPlan:e.collectPlan,context:s});const t=e.getBestPlan();if(null==t)throw new Error("No plan found");return[t]}}const Xe=function(){let e,{scorer:t=Qe}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=Ve,a=0;return{collectPlan:r=>{const s=t(r);if(r.score=s,(null==e||s<=n)&&(e=r,n=s),++a,a>ke)throw new Error("too many plans")},getBestPlan:()=>e}},$e=function(){let{scorer:e=Qe}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=[],n=Ve,a=0;return{collectPlan:r=>{if(++a,a>ke)throw new Error("too many plans");const s=e(r);r.score=s,0===t.length?(t.push(r),n=s):s<n?(t=[r],n=s):s===n&&t.push(r)},getBestPlans:()=>t}};var et=function(e){let{screenProps:t,navigation:n}=e;const{rank:a,cards:r,windowSize:s}=t,l={cards:r,mainRank:a,morePlans:!0,scorer:"HEURISTICS"},{status:c,data:o}=Object(oe.useQuery)(["calc",l],(async()=>(await tt(500),qe(l)))),i={cards:r,mainRank:a,morePlans:!0,scorer:"HANDS"},{status:u,data:d}=Object(oe.useQuery)(["calc",i],(async()=>(await tt(0),qe(i))),{enabled:"success"===c});let b=["loading"];return"success"===c&&(b=[{title:"\u4ef7\u503c\u7b56\u7565",plans:o}],"loading"===u?b.push("loading"):"success"===u&&b.push({title:"\u624b\u6570\u7b56\u7565",plans:d})),Object(g.jsx)(xe,{strategyResult:b,rank:a,windowSize:s,onClose:n.goBack})};function tt(e){return new Promise((t=>{setTimeout(t,e)}))}const nt="NOT_FOUND",at={path:"/not-found",title:"Page Not Found"};var rt=n(48);const st=720;function lt(){const{width:e,height:t}=rt.a.get("window");return e>=st&&t>=st?"BIG":"SMALL"}const ct=o.a.create({absoluteChild:{position:"absolute",left:0,top:0,right:0,bottom:0}}),ot={Home:ce,Result:et},it=e=>{let{route:t,navigation:n,screenProps:a,style:r}=e;return Object(g.jsx)(g.Fragment,{children:Object(g.jsx)(d.TransitionGroup,{children:Object.entries(ot).map((e=>{let[s,l]=e;return s!==t?null:Object(g.jsx)(j,{style:[ct.absoluteChild,r],timeout:300,children:Object(g.jsx)(l,{screenProps:a,navigation:n})},s)}))})})},ut=function(e,t){const n={...e,routes:{...e.routes,[nt]:at}};function a(){const e=t.location.pathname;return e.startsWith(n.base)?(a=e.substring(n.base.length)).endsWith("/")?a.substring(0,a.length-1):a:n.base+at.path;var a}function r(e){const[t,a]=Object.entries(n.routes).find((t=>{let[n,a]=t;return a.path===e}))||[nt,at];return{route:t,routeConfig:a}}return function(){const[e,s]=Object(l.useState)(r(a()).route);Object(l.useEffect)((()=>t.listen((function(e,t){s(r(a()).route)}))),[s]),Object(l.useEffect)((()=>{window.document.title=n.routes[e].title}),[]);const c=Object(l.useCallback)((function(e){let{replace:a=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e=n.routes[e]?e:nt;const r=n.routes[e];a?t.replace(n.base+r.path):t.push(n.base+r.path)}),[n,at]);return{route:e,title:n.routes[e].title,navigation:{navigate:c,goBack:t.goBack}}}}({base:"/poker-guandan-strategy",defaultRoute:"Home",routes:{Home:{path:"",title:"\u63bc\u86cb\u62c6\u724c\u8ba1\u7b97\u5668"},Result:{path:"/result",title:"\u63bc\u86cb\u62c6\u724c\u8ba1\u7b97\u5668"}}},s()());function dt(){const[e,t]=Object(l.useState)(S),n=function(){const[e,t]=Object(l.useState)([]),[n,a]=Object(l.useState)([[],[],[],[]]);return{cards:e,allCards:n,clearCards:Object(l.useCallback)((()=>t([])),[t]),addCard:Object(l.useCallback)((e=>t((t=>t.concat(e)))),[t]),randomCards:Object(l.useCallback)((()=>a(J())),[t]),deleteLastCard:Object(l.useCallback)((()=>t((e=>e.slice(0,e.length-1)))),[t])}}(),a=(()=>{const[e,t]=Object(l.useState)([]);return{strategyResult:e,setResult:t}})(),{route:r,navigation:s}=ut(),c=function(){const[e,t]=Object(l.useState)(lt);return Object(l.useEffect)((()=>{function e(){t(lt())}return rt.a.addEventListener("change",e),()=>rt.a.removeEventListener("change",e)}),[t]),e}();return console.log(n),Object(g.jsx)(i.a,{style:{flex:1,backgroundColor:"lightblue",height:"100%"},children:Object(g.jsxs)(i.a,{style:{height:"100%"},children:[Object(g.jsx)(u.a,{style:{fontSize:14},children:"\u63bc\u86cb\u62c6\u724c\u8ba1\u7b97\u5668"}),Object(g.jsx)(i.a,{style:{flex:1},children:Object(g.jsx)(it,{route:r,screenProps:{rank:e,setRank:t,...n,...a,windowSize:c},navigation:s,style:{flex:1}})})]})})}const bt=new oe.QueryClient;var gt=()=>Object(g.jsx)(oe.QueryClientProvider,{client:bt,children:Object(g.jsx)(dt,{})});const ht=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function jt(e,t){navigator.serviceWorker.register(e).then((e=>{e.onupdatefound=()=>{const n=e.installing;null!=n&&(n.onstatechange=()=>{"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((e=>{console.error("Error during service worker registration:",e)}))}a.a.registerComponent("App",(()=>gt)),a.a.runApplication("App",{rootTag:document.getElementById("root")}),function(e){if("serviceWorker"in navigator){if(new URL("/poker-guandan-strategy/docs",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(()=>{const t="".concat("/poker-guandan-strategy/docs","/service-worker.js");ht?(!function(e,t){fetch(e).then((n=>{const a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((e=>{e.unregister().then((()=>{window.location.reload()}))})):jt(e,t)})).catch((()=>{console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")}))):jt(t,e)}))}}({onSuccess:()=>console.log("service worker loaded successfully"),onUpdate:()=>console.log("service worker is updated")}),function(){const e=window.document.getElementById("wechat-guidance");if(e){const t=e.parentNode;t&&t.removeChild(e)}}()}},[[142,1,2]]]);
//# sourceMappingURL=main.76e943f9.chunk.js.map